#pragma once
#include <array>
#include <iostream>

enum class Marker { NONE, X, O };

struct Board
{
    Board();
    void set_cell(int row, int col, Marker player);
    [[nodiscard]] auto get_cell(int row, int col) const -> Marker;
    [[nodiscard]] auto check_winner() const -> Marker;
    void print_board();
    std::array<std::array<Marker, 5>, 5> board{};
};

inline auto get_opponent(Marker mark) -> Marker { return Marker{ 3 - (int)mark }; }

constexpr int win[28][4][2] = { { { 0, 0 }, { 0, 1 }, { 0, 2 }, { 0, 3 } },
    { { 1, 0 }, { 1, 1 }, { 1, 2 }, { 1, 3 } },
    { { 2, 0 }, { 2, 1 }, { 2, 2 }, { 2, 3 } },
    { { 3, 0 }, { 3, 1 }, { 3, 2 }, { 3, 3 } },
    { { 4, 0 }, { 4, 1 }, { 4, 2 }, { 4, 3 } },
    { { 0, 1 }, { 0, 2 }, { 0, 3 }, { 0, 4 } },
    { { 1, 1 }, { 1, 2 }, { 1, 3 }, { 1, 4 } },
    { { 2, 1 }, { 2, 2 }, { 2, 3 }, { 2, 4 } },
    { { 3, 1 }, { 3, 2 }, { 3, 3 }, { 3, 4 } },
    { { 4, 1 }, { 4, 2 }, { 4, 3 }, { 4, 4 } },
    { { 0, 0 }, { 1, 0 }, { 2, 0 }, { 3, 0 } },
    { { 0, 1 }, { 1, 1 }, { 2, 1 }, { 3, 1 } },
    { { 0, 2 }, { 1, 2 }, { 2, 2 }, { 3, 2 } },
    { { 0, 3 }, { 1, 3 }, { 2, 3 }, { 3, 3 } },
    { { 0, 4 }, { 1, 4 }, { 2, 4 }, { 3, 4 } },
    { { 1, 0 }, { 2, 0 }, { 3, 0 }, { 4, 0 } },
    { { 1, 1 }, { 2, 1 }, { 3, 1 }, { 4, 1 } },
    { { 1, 2 }, { 2, 2 }, { 3, 2 }, { 4, 2 } },
    { { 1, 3 }, { 2, 3 }, { 3, 3 }, { 4, 3 } },
    { { 1, 4 }, { 2, 4 }, { 3, 4 }, { 4, 4 } },
    { { 0, 1 }, { 1, 2 }, { 2, 3 }, { 3, 4 } },
    { { 0, 0 }, { 1, 1 }, { 2, 2 }, { 3, 3 } },
    { { 1, 1 }, { 2, 2 }, { 3, 3 }, { 4, 4 } },
    { { 1, 0 }, { 2, 1 }, { 3, 2 }, { 4, 3 } },
    { { 0, 3 }, { 1, 2 }, { 2, 1 }, { 3, 0 } },
    { { 0, 4 }, { 1, 3 }, { 2, 2 }, { 3, 1 } },
    { { 1, 3 }, { 2, 2 }, { 3, 1 }, { 4, 0 } },
    { { 1, 4 }, { 2, 3 }, { 3, 2 }, { 4, 1 } } };

constexpr int lose[48][3][2] = { { { 0, 0 }, { 0, 1 }, { 0, 2 } },
    { { 0, 1 }, { 0, 2 }, { 0, 3 } },
    { { 0, 2 }, { 0, 3 }, { 0, 4 } },
    { { 1, 0 }, { 1, 1 }, { 1, 2 } },
    { { 1, 1 }, { 1, 2 }, { 1, 3 } },
    { { 1, 2 }, { 1, 3 }, { 1, 4 } },
    { { 2, 0 }, { 2, 1 }, { 2, 2 } },
    { { 2, 1 }, { 2, 2 }, { 2, 3 } },
    { { 2, 2 }, { 2, 3 }, { 2, 4 } },
    { { 3, 0 }, { 3, 1 }, { 3, 2 } },
    { { 3, 1 }, { 3, 2 }, { 3, 3 } },
    { { 3, 2 }, { 3, 3 }, { 3, 4 } },
    { { 4, 0 }, { 4, 1 }, { 4, 2 } },
    { { 4, 1 }, { 4, 2 }, { 4, 3 } },
    { { 4, 2 }, { 4, 3 }, { 4, 4 } },
    { { 0, 0 }, { 1, 0 }, { 2, 0 } },
    { { 1, 0 }, { 2, 0 }, { 3, 0 } },
    { { 2, 0 }, { 3, 0 }, { 4, 0 } },
    { { 0, 1 }, { 1, 1 }, { 2, 1 } },
    { { 1, 1 }, { 2, 1 }, { 3, 1 } },
    { { 2, 1 }, { 3, 1 }, { 4, 1 } },
    { { 0, 2 }, { 1, 2 }, { 2, 2 } },
    { { 1, 2 }, { 2, 2 }, { 3, 2 } },
    { { 2, 2 }, { 3, 2 }, { 4, 2 } },
    { { 0, 3 }, { 1, 3 }, { 2, 3 } },
    { { 1, 3 }, { 2, 3 }, { 3, 3 } },
    { { 2, 3 }, { 3, 3 }, { 4, 3 } },
    { { 0, 4 }, { 1, 4 }, { 2, 4 } },
    { { 1, 4 }, { 2, 4 }, { 3, 4 } },
    { { 2, 4 }, { 3, 4 }, { 4, 4 } },
    { { 0, 2 }, { 1, 3 }, { 2, 4 } },
    { { 0, 1 }, { 1, 2 }, { 2, 3 } },
    { { 1, 2 }, { 2, 3 }, { 3, 4 } },
    { { 0, 0 }, { 1, 1 }, { 2, 2 } },
    { { 1, 1 }, { 2, 2 }, { 3, 3 } },
    { { 2, 2 }, { 3, 3 }, { 4, 4 } },
    { { 1, 0 }, { 2, 1 }, { 3, 2 } },
    { { 2, 1 }, { 3, 2 }, { 4, 3 } },
    { { 2, 0 }, { 3, 1 }, { 4, 2 } },
    { { 0, 2 }, { 1, 1 }, { 2, 0 } },
    { { 0, 3 }, { 1, 2 }, { 2, 1 } },
    { { 1, 2 }, { 2, 1 }, { 3, 0 } },
    { { 0, 4 }, { 1, 3 }, { 2, 2 } },
    { { 1, 3 }, { 2, 2 }, { 3, 1 } },
    { { 2, 2 }, { 3, 1 }, { 4, 0 } },
    { { 1, 4 }, { 2, 3 }, { 3, 2 } },
    { { 2, 3 }, { 3, 2 }, { 4, 1 } },
    { { 2, 4 }, { 3, 3 }, { 4, 2 } } };
